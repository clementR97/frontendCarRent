<div class="login-wrapper">
    <div class="login-container">
      <button class="close-btn" (click)="goToHome()" aria-label="Retour à l'accueil">
        <mat-icon>close</mat-icon>
      </button>
      
      <!-- Header -->
      <div class="login-header">
        <div class="logo-container">
          <div class="logo-icon"></div>
        </div>
        <h1 class="login-title">Mot de passe Oublié</h1>
        
        <!-- Message de succès -->
        <div class="success-message" *ngIf="showSuccessMessage">
          <div class="success-icon">
            <mat-icon>check_circle</mat-icon>
          </div>
          <p>{{ successMessage }}</p>
          <p class="success-subtitle">
            Vérifiez votre boîte email et suivez les instructions pour réinitialiser votre mot de passe.
          </p>
          <button type="button" class="link-btn" (click)="retryReset()">
            Renvoyer l'email
          </button>
        </div>
  
        <!-- Formulaire -->
        <form 
          *ngIf="!showSuccessMessage" 
          [formGroup]="passwordForm" 
          (ngSubmit)="passwordforgot()" 
          class="login-form"
        >
          
          <!-- Message d'erreur général -->
          <div class="general-error" *ngIf="generalError">
            <mat-icon>error</mat-icon>
            <span>{{ generalError }}</span>
          </div>
  
          <div class="form-field">
            <label class="form-label" for="email">Adresse e-mail</label>
            <div class="input-wrapper">
              <div class="input-icon">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                  <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                </svg>
              </div>
              <input
                type="email"
                id="email"
                formControlName="email"
                placeholder="vous@exemple.com"
                class="form-input"
                [class.error]="isFieldInvalid('email')"
                autocomplete="email"
              />
            </div>
            <div class="field-error" *ngIf="isFieldInvalid('email')">
              <span *ngIf="passwordForm.get('email')?.errors?.['required']">
                L'adresse e-mail est requise
              </span>
              <span *ngIf="passwordForm.get('email')?.errors?.['email']">
                Veuillez saisir une adresse e-mail valide
              </span>
            </div>
          </div>
  
          <!-- Bouton envoyer mail de réinitialisation -->
          <button
            type="submit"
            class="submit-btn"
            [disabled]="isLoading || passwordForm.invalid"
          >
            <div class="loading-spinner" *ngIf="isLoading"></div>
            <span>{{ isLoading ? 'Envoi en cours...' : 'Envoyer le lien de réinitialisation' }}</span>
          </button>
          
          <!-- Lien retour à la connexion -->
          <div class="form-footer">
            <button type="button" class="link-btn" (click)="goToSubmit($event)">
              ← Retour à la connexion
            </button>
          </div>
          
        </form>
      </div>
    </div>
  </div>